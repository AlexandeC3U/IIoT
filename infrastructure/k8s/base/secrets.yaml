# NEXUS Edge Platform - Secrets
# ============================================================================
# ⚠️  DEVELOPMENT ONLY - DO NOT USE IN PRODUCTION AS-IS!
# ============================================================================
#
# For production, use one of:
#   1. External Secrets Operator (ESO) with AWS/GCP/Azure/Vault backend
#   2. Sealed Secrets for GitOps workflows
#   3. HashiCorp Vault with Vault Agent Injector
#   4. Cloud provider secret management (AWS Secrets Manager, etc.)
#
# To replace with External Secrets Operator, see:
#   infrastructure/k8s/overlays/prod/external-secrets.yaml
#
# Generate strong passwords for production:
#   openssl rand -base64 32
# ============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: nexus-secrets
  namespace: nexus
  labels:
    app.kubernetes.io/name: nexus
    app.kubernetes.io/part-of: nexus-edge
  annotations:
    description: "Main credentials for NEXUS Edge services"
type: Opaque
stringData:
  # MQTT Credentials (used by protocol-gateway and data-ingestion)
  MQTT_USERNAME: "nexus"
  MQTT_PASSWORD: "nexus_dev_changeme"
  
  # TimescaleDB Credentials (used by data-ingestion)
  TIMESCALEDB_USER: "nexus_ingestion"
  TIMESCALEDB_PASSWORD: "ingestion_dev_changeme"

---
# TimescaleDB specific secrets
apiVersion: v1
kind: Secret
metadata:
  name: timescaledb-secrets
  namespace: nexus
  labels:
    app.kubernetes.io/name: timescaledb
    app.kubernetes.io/part-of: nexus-edge
  annotations:
    description: "PostgreSQL/TimescaleDB admin and application credentials"
type: Opaque
stringData:
  # PostgreSQL superuser (for admin operations)
  POSTGRES_USER: "postgres"
  POSTGRES_PASSWORD: "postgres_admin_changeme"
  POSTGRES_DB: "nexus_historian"
  
  # Application role passwords (injected into init scripts)
  NEXUS_HISTORIAN_PASSWORD: "historian_dev_changeme"
  NEXUS_INGESTION_PASSWORD: "ingestion_dev_changeme"
  
  # PostgreSQL Exporter DSN (uses postgres superuser for metrics)
  EXPORTER_DSN: "postgresql://postgres:postgres_admin_changeme@localhost:5432/nexus_historian?sslmode=disable"

---
# EMQX specific secrets
apiVersion: v1
kind: Secret
metadata:
  name: emqx-secrets
  namespace: nexus
  labels:
    app.kubernetes.io/name: emqx
    app.kubernetes.io/part-of: nexus-edge
  annotations:
    description: "EMQX MQTT broker credentials"
type: Opaque
stringData:
  # Dashboard admin credentials
  EMQX_DASHBOARD__DEFAULT_USERNAME: "admin"
  EMQX_DASHBOARD__DEFAULT_PASSWORD: "emqx_admin_changeme"
  
  # MQTT authentication credentials (for client auth)
  MQTT_ADMIN_USERNAME: "nexus_admin"
  MQTT_ADMIN_PASSWORD: "mqtt_admin_changeme"

